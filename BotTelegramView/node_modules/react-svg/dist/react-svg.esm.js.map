{"version":3,"file":"react-svg.esm.js","sources":["../compiled/shallow-differs.js","../compiled/ReactSVG.js"],"sourcesContent":["// Hat-tip: https://github.com/developit/preact-compat/blob/master/src/index.js#L402.\nconst shallowDiffers = (a, b) => {\n    for (const i in a) {\n        if (!(i in b)) {\n            return true;\n        }\n    }\n    for (const i in b) {\n        if (a[i] !== b[i]) {\n            return true;\n        }\n    }\n    return false;\n};\nexport default shallowDiffers;\n","import { SVGInjector } from '@tanem/svg-injector';\nimport * as PropTypes from 'prop-types';\nimport * as React from 'react';\nimport ReactDOMServer from 'react-dom/server';\nimport shallowDiffers from './shallow-differs';\nlet ReactSVG = /** @class */ (() => {\n    class ReactSVG extends React.Component {\n        constructor() {\n            super(...arguments);\n            this.initialState = {\n                hasError: false,\n                isLoading: true,\n            };\n            this.state = this.initialState;\n            this._isMounted = false;\n            this.refCallback = (container) => {\n                this.container = container;\n            };\n        }\n        renderSVG() {\n            /* istanbul ignore else */\n            if (this.container instanceof Node) {\n                const { beforeInjection, evalScripts, renumerateIRIElements, src, } = this.props;\n                /* eslint-disable @typescript-eslint/no-non-null-assertion */\n                const afterInjection = this.props.afterInjection;\n                const Wrapper = this.props.wrapper;\n                /* eslint-enable @typescript-eslint/no-non-null-assertion */\n                const wrapper = document.createElement(Wrapper);\n                wrapper.innerHTML = ReactDOMServer.renderToStaticMarkup(React.createElement(Wrapper, null,\n                    React.createElement(Wrapper, { \"data-src\": src })));\n                this.svgWrapper = this.container.appendChild(wrapper.firstChild);\n                const afterEach = (error, svg) => {\n                    if (error) {\n                        this.removeSVG();\n                    }\n                    // TODO: It'd be better to cleanly unsubscribe from SVGInjector\n                    // callbacks instead of tracking a property like this.\n                    if (this._isMounted) {\n                        this.setState(() => ({\n                            hasError: !!error,\n                            isLoading: false,\n                        }), () => {\n                            afterInjection(error, svg);\n                        });\n                    }\n                };\n                SVGInjector(this.svgWrapper.firstChild, {\n                    afterEach,\n                    beforeEach: beforeInjection,\n                    evalScripts,\n                    renumerateIRIElements,\n                });\n            }\n        }\n        removeSVG() {\n            if (this.container instanceof Node && this.svgWrapper instanceof Node) {\n                this.container.removeChild(this.svgWrapper);\n                this.svgWrapper = null;\n            }\n        }\n        componentDidMount() {\n            this._isMounted = true;\n            this.renderSVG();\n        }\n        componentDidUpdate(prevProps) {\n            if (shallowDiffers(prevProps, this.props)) {\n                this.setState(() => this.initialState, () => {\n                    this.removeSVG();\n                    this.renderSVG();\n                });\n            }\n        }\n        componentWillUnmount() {\n            this._isMounted = false;\n            this.removeSVG();\n        }\n        render() {\n            /* eslint-disable @typescript-eslint/no-unused-vars */\n            const { afterInjection, beforeInjection, evalScripts, fallback: Fallback, loading: Loading, renumerateIRIElements, src, wrapper, ...rest } = this.props;\n            /* eslint-enable @typescript-eslint/no-unused-vars */\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            const Wrapper = wrapper;\n            return (React.createElement(Wrapper, Object.assign({}, rest, { ref: this.refCallback }),\n                this.state.isLoading && Loading && React.createElement(Loading, null),\n                this.state.hasError && Fallback && React.createElement(Fallback, null)));\n        }\n    }\n    ReactSVG.defaultProps = {\n        afterInjection: () => undefined,\n        beforeInjection: () => undefined,\n        evalScripts: 'never',\n        fallback: null,\n        loading: null,\n        renumerateIRIElements: true,\n        wrapper: 'div',\n    };\n    ReactSVG.propTypes = {\n        afterInjection: PropTypes.func,\n        beforeInjection: PropTypes.func,\n        evalScripts: PropTypes.oneOf(['always', 'once', 'never']),\n        fallback: PropTypes.oneOfType([\n            PropTypes.func,\n            PropTypes.object,\n            PropTypes.string,\n        ]),\n        loading: PropTypes.oneOfType([\n            PropTypes.func,\n            PropTypes.object,\n            PropTypes.string,\n        ]),\n        renumerateIRIElements: PropTypes.bool,\n        src: PropTypes.string.isRequired,\n        wrapper: PropTypes.oneOf(['div', 'span']),\n    };\n    return ReactSVG;\n})();\nexport { ReactSVG };\n"],"names":["shallowDiffers","a","b","i","ReactSVG","arguments","initialState","hasError","isLoading","state","_isMounted","refCallback","container","renderSVG","Node","props","beforeInjection","evalScripts","renumerateIRIElements","src","afterInjection","Wrapper","wrapper","document","createElement","innerHTML","ReactDOMServer","renderToStaticMarkup","React","svgWrapper","appendChild","firstChild","afterEach","error","svg","removeSVG","setState","SVGInjector","beforeEach","removeChild","componentDidMount","componentDidUpdate","prevProps","componentWillUnmount","render","Fallback","fallback","Loading","loading","rest","Object","assign","ref","defaultProps","undefined","propTypes","PropTypes","isRequired"],"mappings":";;;;;;;AAAA;AACA,IAAMA,cAAc,GAAG,SAAjBA,cAAiB,CAACC,CAAD,EAAIC,CAAJ,EAAU;AAC7B,OAAK,IAAMC,CAAX,IAAgBF,CAAhB,EAAmB;AACf,QAAI,EAAEE,CAAC,IAAID,CAAP,CAAJ,EAAe;AACX,aAAO,IAAP;AACH;AACJ;;AACD,OAAK,IAAMC,EAAX,IAAgBD,CAAhB,EAAmB;AACf,QAAID,CAAC,CAACE,EAAD,CAAD,KAASD,CAAC,CAACC,EAAD,CAAd,EAAmB;AACf,aAAO,IAAP;AACH;AACJ;;AACD,SAAO,KAAP;AACH,CAZD;;ICIIC,QAAQ;AAAG;AAAe,YAAM;AAAA,MAC1BA,QAD0B;AAAA;;AAE5B,wBAAc;AAAA;;AACV,2CAASC,SAAT;AACA,YAAKC,YAAL,GAAoB;AAChBC,QAAAA,QAAQ,EAAE,KADM;AAEhBC,QAAAA,SAAS,EAAE;AAFK,OAApB;AAIA,YAAKC,KAAL,GAAa,MAAKH,YAAlB;AACA,YAAKI,UAAL,GAAkB,KAAlB;;AACA,YAAKC,WAAL,GAAmB,UAACC,SAAD,EAAe;AAC9B,cAAKA,SAAL,GAAiBA,SAAjB;AACH,OAFD;;AARU;AAWb;;AAb2B;;AAAA,WAc5BC,SAd4B,GAc5B,qBAAY;AAAA;;AACR;AACA,UAAI,KAAKD,SAAL,YAA0BE,IAA9B,EAAoC;AAAA,0BACsC,KAAKC,KAD3C;AAAA,YACxBC,eADwB,eACxBA,eADwB;AAAA,YACPC,WADO,eACPA,WADO;AAAA,YACMC,qBADN,eACMA,qBADN;AAAA,YAC6BC,GAD7B,eAC6BA,GAD7B;AAEhC;;AACA,YAAMC,cAAc,GAAG,KAAKL,KAAL,CAAWK,cAAlC;AACA,YAAMC,OAAO,GAAG,KAAKN,KAAL,CAAWO,OAA3B;AACA;;AACA,YAAMA,OAAO,GAAGC,QAAQ,CAACC,aAAT,CAAuBH,OAAvB,CAAhB;AACAC,QAAAA,OAAO,CAACG,SAAR,GAAoBC,cAAc,CAACC,oBAAf,CAAoCC,aAAA,CAAoBP,OAApB,EAA6B,IAA7B,EACpDO,aAAA,CAAoBP,OAApB,EAA6B;AAAE,sBAAYF;AAAd,SAA7B,CADoD,CAApC,CAApB;AAEA,aAAKU,UAAL,GAAkB,KAAKjB,SAAL,CAAekB,WAAf,CAA2BR,OAAO,CAACS,UAAnC,CAAlB;;AACA,YAAMC,SAAS,GAAG,SAAZA,SAAY,CAACC,KAAD,EAAQC,GAAR,EAAgB;AAC9B,cAAID,KAAJ,EAAW;AACP,YAAA,MAAI,CAACE,SAAL;AACH,WAH6B;AAK9B;;;AACA,cAAI,MAAI,CAACzB,UAAT,EAAqB;AACjB,YAAA,MAAI,CAAC0B,QAAL,CAAc;AAAA,qBAAO;AACjB7B,gBAAAA,QAAQ,EAAE,CAAC,CAAC0B,KADK;AAEjBzB,gBAAAA,SAAS,EAAE;AAFM,eAAP;AAAA,aAAd,EAGI,YAAM;AACNY,cAAAA,cAAc,CAACa,KAAD,EAAQC,GAAR,CAAd;AACH,aALD;AAMH;AACJ,SAdD;;AAeAG,QAAAA,WAAW,CAAC,KAAKR,UAAL,CAAgBE,UAAjB,EAA6B;AACpCC,UAAAA,SAAS,EAATA,SADoC;AAEpCM,UAAAA,UAAU,EAAEtB,eAFwB;AAGpCC,UAAAA,WAAW,EAAXA,WAHoC;AAIpCC,UAAAA,qBAAqB,EAArBA;AAJoC,SAA7B,CAAX;AAMH;AACJ,KAhD2B;;AAAA,WAiD5BiB,SAjD4B,GAiD5B,qBAAY;AACR,UAAI,KAAKvB,SAAL,YAA0BE,IAA1B,IAAkC,KAAKe,UAAL,YAA2Bf,IAAjE,EAAuE;AACnE,aAAKF,SAAL,CAAe2B,WAAf,CAA2B,KAAKV,UAAhC;AACA,aAAKA,UAAL,GAAkB,IAAlB;AACH;AACJ,KAtD2B;;AAAA,WAuD5BW,iBAvD4B,GAuD5B,6BAAoB;AAChB,WAAK9B,UAAL,GAAkB,IAAlB;AACA,WAAKG,SAAL;AACH,KA1D2B;;AAAA,WA2D5B4B,kBA3D4B,GA2D5B,4BAAmBC,SAAnB,EAA8B;AAAA;;AAC1B,UAAI1C,cAAc,CAAC0C,SAAD,EAAY,KAAK3B,KAAjB,CAAlB,EAA2C;AACvC,aAAKqB,QAAL,CAAc;AAAA,iBAAM,MAAI,CAAC9B,YAAX;AAAA,SAAd,EAAuC,YAAM;AACzC,UAAA,MAAI,CAAC6B,SAAL;;AACA,UAAA,MAAI,CAACtB,SAAL;AACH,SAHD;AAIH;AACJ,KAlE2B;;AAAA,WAmE5B8B,oBAnE4B,GAmE5B,gCAAuB;AACnB,WAAKjC,UAAL,GAAkB,KAAlB;AACA,WAAKyB,SAAL;AACH,KAtE2B;;AAAA,WAuE5BS,MAvE4B,GAuE5B,kBAAS;AACL;AADK,yBAEwI,KAAK7B,KAF7I;AAAA,UAEGK,cAFH,gBAEGA,cAFH;AAAA,UAEmBJ,eAFnB,gBAEmBA,eAFnB;AAAA,UAEoCC,WAFpC,gBAEoCA,WAFpC;AAAA,UAE2D4B,QAF3D,gBAEiDC,QAFjD;AAAA,UAE8EC,OAF9E,gBAEqEC,OAFrE;AAAA,UAEuF9B,qBAFvF,gBAEuFA,qBAFvF;AAAA,UAE8GC,GAF9G,gBAE8GA,GAF9G;AAAA,UAEmHG,OAFnH,gBAEmHA,OAFnH;AAAA,UAE+H2B,IAF/H;AAGL;AACA;;;AACA,UAAM5B,OAAO,GAAGC,OAAhB;AACA,aAAQM,aAAA,CAAoBP,OAApB,EAA6B6B,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkBF,IAAlB,EAAwB;AAAEG,QAAAA,GAAG,EAAE,KAAKzC;AAAZ,OAAxB,CAA7B,EACJ,KAAKF,KAAL,CAAWD,SAAX,IAAwBuC,OAAxB,IAAmCnB,aAAA,CAAoBmB,OAApB,EAA6B,IAA7B,CAD/B,EAEJ,KAAKtC,KAAL,CAAWF,QAAX,IAAuBsC,QAAvB,IAAmCjB,aAAA,CAAoBiB,QAApB,EAA8B,IAA9B,CAF/B,CAAR;AAGH,KAhF2B;;AAAA;AAAA,IACTjB,SADS;;AAkFhCxB,EAAAA,QAAQ,CAACiD,YAAT,GAAwB;AACpBjC,IAAAA,cAAc,EAAE;AAAA,aAAMkC,SAAN;AAAA,KADI;AAEpBtC,IAAAA,eAAe,EAAE;AAAA,aAAMsC,SAAN;AAAA,KAFG;AAGpBrC,IAAAA,WAAW,EAAE,OAHO;AAIpB6B,IAAAA,QAAQ,EAAE,IAJU;AAKpBE,IAAAA,OAAO,EAAE,IALW;AAMpB9B,IAAAA,qBAAqB,EAAE,IANH;AAOpBI,IAAAA,OAAO,EAAE;AAPW,GAAxB;AASAlB,EAAAA,QAAQ,CAACmD,SAAT,IAAqB;AACjBnC,IAAAA,cAAc,EAAEoC,IADC;AAEjBxC,IAAAA,eAAe,EAAEwC,IAFA;AAGjBvC,IAAAA,WAAW,EAAEuC,KAAA,CAAgB,CAAC,QAAD,EAAW,MAAX,EAAmB,OAAnB,CAAhB,CAHI;AAIjBV,IAAAA,QAAQ,EAAEU,SAAA,CAAoB,CAC1BA,IAD0B,EAE1BA,MAF0B,EAG1BA,MAH0B,CAApB,CAJO;AASjBR,IAAAA,OAAO,EAAEQ,SAAA,CAAoB,CACzBA,IADyB,EAEzBA,MAFyB,EAGzBA,MAHyB,CAApB,CATQ;AAcjBtC,IAAAA,qBAAqB,EAAEsC,IAdN;AAejBrC,IAAAA,GAAG,EAAEqC,MAAA,CAAiBC,UAfL;AAgBjBnC,IAAAA,OAAO,EAAEkC,KAAA,CAAgB,CAAC,KAAD,EAAQ,MAAR,CAAhB;AAhBQ,GAArB;AAkBA,SAAOpD,QAAP;AACH,CA9G4B;;;;"}